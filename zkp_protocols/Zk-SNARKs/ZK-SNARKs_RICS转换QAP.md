在将 R1CS 系统转换为 QAP（Quadratic Arithmetic Programs）系统之前，我们先来了解一下 QAP 的概念。QAP 是一种特殊的多项式表示形式，用于表示算术电路。QAP 有助于实现更高效的零知识证明，因为它可以对证明和验证过程进行优化。

现在，我们详细解释如何将 R1CS 系统转换为 QAP 系统。在我们的示例中，我们有以下 R1CS 系统：

```
A = [(1, 0, -1), (0, 1, 0)]
B = [(0, 0,  1), (0, 1, 0)]
C = [(1, 0,  0), (0, 0, 1)]
```

### 将 R1CS 系统转换为 QAP 系统

为了将 R1CS 系统表示为 QAP，我们需要执行以下步骤：

1. **分配每个门一个多项式**：我们将为每个门分配一个多项式，这些多项式将用于构建 QAP。在我们的示例中，我们有两个门，因此我们分配以下多项式：

   ```
   乘法门：L1(x), R1(x), O1(x)
   减法门：L2(x), R2(x), O2(x)
   ```

2. **找到插值多项式**：接下来，我们需要找到插值多项式，这些多项式将用于表示线性组合。我们使用拉格朗日插值法来找到这些插值多项式。在我们的示例中，我们需要为每个门找到插值多项式，如下所示：

   ```
   乘法门：L1(1) = 1, L1(2) = 0
   减法门：L2(1) = 0, L2(2) = 1
   ```

   使用这些值，我们可以找到插值多项式：

   ```
   L1(x) = (x - 2) / (1 - 2) = - (x - 2)
   L2(x) = (x - 1) / (2 - 1) = x - 1
   ```

3. **构建 QAP 多项式**：最后，我们将使用插值多项式构建 QAP 多项式。在我们的示例中，我们构建以下 QAP 多项式：

   ```
   L(x) = (1, 0, -1) * L1(x) + (0, 1, 0) * L2(x) = - (x - 2) + (x - 1)
   R(x) = (0, 0, 1) * L1(x) + (0, 1, 0) * L2(x) = (x - 1)
   O(x) = (1, 0, 0) * L1(x) + (0, 0, 1) * L2(x) = - (x - 2) + x - 1


在上一步，我们构建了 QAP 多项式 L(x), R(x) 和 O(x)。现在我们将继续下一个步骤。

### QAP 评估及证明

在 QAP 中，证明者需要评估 L(x), R(x) 和 O(x) 多项式，并使用一个秘密参数 `s`，证明者将计算这些多项式在 `s` 处的值。假设 `s` 是一个秘密参数，证明者计算以下值：

```
L(s) = L(s) = - (s - 2) + (s - 1)
R(s) = R(s) = (s - 1)
O(s) = O(s) = - (s - 2) + s - 1
```

这些值将用于生成 zk-SNARK 证明。证明者需要向验证者提供证明，即这些值满足 QAP 约束，即 `L(s) * R(s) = O(s)`。

证明者需要确保他们不泄露关于 `s` 或其它秘密参数的信息。为此，证明者可以使用同态隐藏属性，通过将这些值与隐藏参数相乘，以此生成一个零知识证明。

验证者不需要知道 `s` 的值或计算整个 QAP，验证者只需要确保证明者提供的证明是有效的。

### 总结

QAP 系统是一个有效的工具，可用于在不泄露相关信息的情况下验证算术电路的正确性。QAP 系统通过将 R1CS 系统转换为一组多项式来实现这一目标。验证者可以使用这些多项式来验证证明者知道满足约束的解，而无需了解解的具体值。

在我们的示例中，我们演示了如何将 Alice 的问题从 R1CS 系统转换为 QAP 系统。通过将问题表示为 QAP，我们可以使用 zk-SNARKs 等先进技术来生成可验证的零知识证明。